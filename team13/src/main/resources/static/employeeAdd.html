<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset=" utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="renderer" content="webkit" />
	<title>勤怠管理システム</title>
	<link rel="shortcut icon" href="https://i.jpg.dog/3239c9f8261900ee0a360263c616c50d.png" />
	<link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
	<link href="//cdn.staticfile.org/layui/2.8.18/css/layui.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/@unocss/runtime"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.7.15/vue.min.js"></script>
	<script src="https://unpkg.com/element-ui/lib/index.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.2/axios.min.js"></script>
	<script src="//cdn.staticfile.org/layui/2.8.18/layui.js"></script>
</head>

<body>
	<div id="app">
		<div class="layui-layout layui-layout-admin">
			<div class="layui-header">
				<div class="layui-logo layui-hide-xs layui-bg-black">社員情報登録・更新</div>
			</div>
			<div class="layui-body">
				<!-- 内容主体区域 -->
				<div style="padding: 15px;">


					<form class="layui-form layui-form-pane wid" action="">

						<div class="layui-form-item">
							<label class="layui-form-label" style="width: 140px">社員ID</label>
							<div class="layui-input-inline layui-input-wrap">
								<input type="text" name="employeeId" class="layui-input" lay-verify="required" readonly>
							</div>
						</div>


						<div class="layui-form-item">
							<label class="layui-form-label " style="width: 140px">入社年月日
							<span style="color:red">*</span></label>
							<div class="layui-input-inline layui-input-wrap">
								<input type="text" name="startDay" class="layui-input" required>
							</div>
						</div>
						
						<div class="layui-form-item">
							<label class="layui-form-label " style="width: 140px">氏名
							<span style="color:red">*</span></label>
							<div class="layui-input-inline layui-input-wrap">
								<input type="text" name="employeeName" class="layui-input" required>
							</div>
						</div>
						
						<div class="layui-form-item">
							<label class="layui-form-label " style="width: 140px">性别
							<span style="color:red">*</span></label>
							<div class="layui-input-inline layui-input-wrap">
								<input type="radio" name="genderId" value="0" class="layui-input" required>男性
								<input type="radio" name="genderId" value="1" class="layui-input">女性
								<input type="radio" name="genderId" value="9" class="layui-input">未確認
							</div>
						</div>
						
						<div class="layui-form-item">
							<label class="layui-form-label " style="width: 140px">年龄</label>
							<div class="layui-input-inline layui-input-wrap">
								<input type="number" name="age" class="layui-input">
							</div>
						</div>
						
						<div class="layui-form-item">
							<label class="layui-form-label " style="width: 140px">所属
							<span style="color:red">*</span></label>
							<div class="layui-input-inline layui-input-wrap">
								<select name="deptId">
	  								<option value="1">销售部</option>
	  								<option value="2"></option>
	  								<option value="3"></option>
	 								<option value="4"></option>
	 								<option value="5"></option>
	  								<option value="6"></option>
								</select>
							</div>
						</div>

						<div class="layui-form-item">
							<label class="layui-form-label" style="width: 140px">メールアドレス</label>
							<div class="layui-input-inline layui-input-wrap">
								<input type="email" name="emailAddress" class="layui-input">
							</div>
						</div>

						<div class="layui-form-item">
							<label class="layui-form-label" style="width: 140px">電話番号</label>
							<div class="layui-input-inline layui-input-wrap">
								<input type="tel" placeholder="11桁の携帯電話番号を入力してください" name="iphone" class="layui-input">
							</div>
						</div>

						<div class="layui-form-item">
							<button class="layui-btn " lay-submit lay-filter="demo2">登録</button>
						</div>
					</form>

					<button lay-event="backTo" class="layui-btn layui-btn-primary "
						style="top: -53px; left: 99px;position: relative;">閉じる</button>

				</div>
			</div>
		</div>



		<script>
			function dateHandle(dateTimeString) {

				console.log(dateTimeString)

				const date = new Date(dateTimeString);
				const year = date.getFullYear();
				const month = (date.getMonth() + 1).toString().padStart(2, '0');
				const day = date.getDate().toString().padStart(2, '0');
				const hours = date.getHours().toString().padStart(2, '0');
				const minutes = date.getMinutes().toString().padStart(2, '0');
				const seconds = date.getSeconds().toString().padStart(2, '0');

				return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
			}
			new Vue({
				el: '#app',
				data() {
					return {
						msg: '登录成功！',
					}
				},
				mounted() {
					this.getInfo()
					this.queryEmpMaxId()
				},
				methods: {
					async getInfo(){
						const params = new URLSearchParams(window.location.search);
						const employeeId = params.get('employeeId')
						let res = await axios({
							url: 'http://localhost:8080/employee/queryEmpById/' + employeeId,
							method: 'get',
						})
						data = res.data.data
						console.log(data)
					},
					async init() {
							let res = await axios({
								url: 'http://localhost:8080/employee/addOrUpdateEmp',
								method: 'get',
							})
							data = res.data.data
							console.log(data)
					},
					async queryEmpMaxId() {
						let res = await axios({
							url: 'http://localhost:8080/employee/queryEmpMaxId',
							method: 'get',
							data: {
							},
							success: function (data) {
				                if (res.data.code == 200) {
				                    $("#employeeId").val(data.res.employeeId);
				                }
				            },
				            error: function (XMLHttpRequest, textStatus, errorThrown) {
				                alert("系统错误");
				            }
						})
					},
				},
			})
			layui.use(['table', 'dropdown', 'form'], function () {
				var table = layui.table;
				var dropdown = layui.dropdown;
				var util = layui.util;
				var form = layui.form;
				var layer = layui.layer;
				// 提交事件
				form.on('submit(demo2)', async function (data) {
					var field = data.field; // 获取表单字段值
					delete field.employeeId;
					delete field.startDay;
					delete field.employeeName;
					delete field.genderId;
					delete field.age;
					delete field.deptId;
					delete field.emailAddress;
					delete field.iphone;
					console.log(JSON.stringify(field))
					// 此处可执行 Ajax 等操作

					console.log(await axios({
						url: 'http://localhost:8080/api/list',
						method: 'post',
						data: field
					}))

					return false;
				});
				util.on('lay-event', {
					logout: async function () {
						console.log('logout....')
						let res = await axios({
							url: 'http://localhost:8888/api/logout',
							method: 'get',
						})
						console.log('res-------->', res)
						if (String(res.data.code) === '1') {
							localStorage.setItem('userInfo', '')
							location.reload()
						} else {
							this.$message.error(res.data.msg)
						}

					},
					backTo: function () {
						window.location.href = 'http://localhost:8080/NewFile.html'
					},
				});
			})
		</script>
		<style>
			html body {
				margin: 0;
				padding: 0;
				height: 100%;
			}

			.el-form-item__content {
				display: flex;
				justify-content: space-around;
			}

		</style>
</body>

</html>